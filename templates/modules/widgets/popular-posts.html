<!DOCTYPE html>
<html xmlns:th="https://www.thymeleaf.org">

<!-- ========================================== -->
<!--   热门文章组件 - 带描述和徽章的简约风格   -->
<!-- ========================================== -->

<div th:fragment="list"
  class="card bg-base-100/80 backdrop-blur-xl shadow-lg border border-base-content/5 rounded-[1.5rem] p-5" th:with="cfg = ${theme.config.general.sidebar_settings},
           postCount = ${cfg?.popular_posts_count ?: 5},
           popularPosts = ${postFinder.list({page: 1, size: postCount, sort: {'stats.visit,desc'}})}">

  <!-- 标题栏 -->
  <div class="flex items-center gap-3 mb-4">
    <div class="w-9 h-9 rounded-xl bg-gradient-to-br from-error/20 to-error/10 flex items-center justify-center">
      <span class="icon-[heroicons--fire] w-5 h-5 text-error"></span>
    </div>
    <div>
      <span class="font-bold text-base-content">热门文章</span>
      <p class="text-xs text-base-content/40">最受欢迎的内容</p>
    </div>
  </div>

  <!-- 文章列表 -->
  <div class="space-y-4">
    <a th:each="post, iterStat : ${popularPosts.items}" th:href="@{${post.status.permalink}}"
      th:title="${post.spec.title}" class="block group cursor-pointer">

      <!-- 标题行 with 徽章 -->
      <div class="flex items-start gap-2">
        <!-- TOP 徽章 - 仅前3名 -->
        <span th:if="${iterStat.index < 3}" class="shrink-0 text-[10px] font-bold px-1.5 py-0.5 rounded" th:classappend="${iterStat.index == 0} ? 'bg-gradient-to-r from-amber-400 to-orange-500 text-white' : 
                              (${iterStat.index == 1} ? 'bg-gradient-to-r from-slate-300 to-slate-400 text-white' : 
                              'bg-gradient-to-r from-amber-600 to-amber-700 text-white')"
          th:text="|TOP${iterStat.index + 1}|">TOP1</span>

        <!-- 标题 -->
        <h4 class="text-sm font-medium text-base-content truncate group-hover:text-primary transition-colors flex-1"
          th:text="${post.spec.title}">文章标题</h4>
      </div>

      <!-- 描述/摘要 - 单行省略 -->
      <p class="text-xs text-base-content/50 mt-1 truncate"
        th:if="${post.spec.excerpt != null and post.spec.excerpt.raw != null and !post.spec.excerpt.raw.isEmpty()}"
        th:text="${post.spec.excerpt.raw}">文章摘要...</p>

      <!-- 元信息徽章 -->
      <div class="flex items-center gap-2 mt-2">
        <span
          class="inline-flex items-center gap-1 px-2 py-0.5 rounded-full bg-base-200/60 text-[10px] text-base-content/50">
          <span class="icon-[heroicons--eye] w-3 h-3"></span>
          <span th:text="${post.stats.visit ?: 0}">0</span>
        </span>
        <span
          class="inline-flex items-center gap-1 px-2 py-0.5 rounded-full bg-base-200/60 text-[10px] text-base-content/50">
          <span class="icon-[heroicons--heart] w-3 h-3"></span>
          <span th:text="${post.stats.upvote ?: 0}">0</span>
        </span>
        <span
          class="inline-flex items-center gap-1 px-2 py-0.5 rounded-full bg-base-200/60 text-[10px] text-base-content/50">
          <span class="icon-[heroicons--chat-bubble-left] w-3 h-3"></span>
          <span th:text="${post.stats.comment ?: 0}">0</span>
        </span>
      </div>
    </a>
  </div>
</div>

</html>