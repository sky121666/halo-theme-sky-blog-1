<!DOCTYPE html>
<html xmlns:th="https://www.thymeleaf.org">

<!-- ========================================== -->
<!--   作者卡片组件 - 简约风格                   -->
<!--   登录/未登录完全分开，不继承              -->
<!-- ========================================== -->

<th:block th:fragment="card"
  th:with="currentUser = ${contributorFinder.getContributor(#authentication.name)},
           isLoggedIn = ${currentUser != null and !#strings.equals(currentUser.name, 'anonymousUser')}">

<!-- ========== 已登录用户卡片 ========== -->
<div th:if="${isLoggedIn}"
  class="card bg-base-100/80 backdrop-blur-xl shadow-lg border border-base-content/5 rounded-2xl p-5 relative overflow-hidden group hover:shadow-xl hover:border-primary/20 transition-all duration-300">

  <!-- 背景装饰 - 多层渐变 -->
  <div class="absolute -top-12 -right-12 w-36 h-36 bg-gradient-to-br from-success/10 via-primary/8 to-secondary/10 rounded-full blur-2xl group-hover:scale-110 transition-transform duration-500"></div>
  <div class="absolute -bottom-8 -left-8 w-24 h-24 bg-gradient-to-tr from-primary/8 to-accent/5 rounded-full blur-xl opacity-50"></div>

  <!-- 头像和信息 -->
  <div class="relative flex items-center gap-4">
    <div class="relative flex-shrink-0">
      <div class="w-12 h-12 rounded-xl overflow-hidden bg-base-200 ring-1 ring-base-content/10">
        <img th:src="${currentUser.avatar}" th:if="${currentUser.avatar != null and !#strings.isEmpty(currentUser.avatar)}" alt="avatar" class="w-full h-full object-cover" />
        <img th:src="${site.logo}" th:unless="${currentUser.avatar != null and !#strings.isEmpty(currentUser.avatar)}" alt="avatar" class="w-full h-full object-cover" />
      </div>
      <!-- 在线点 -->
      <div class="absolute -bottom-0.5 -right-0.5 w-3 h-3 bg-success rounded-full ring-2 ring-base-100"></div>
    </div>
    
    <div class="flex-1 min-w-0">
      <h3 class="text-base font-semibold text-base-content truncate" th:text="${currentUser.displayName}">用户</h3>
      <p class="text-xs text-base-content/50 mt-0.5 flex items-center gap-1">
        <span class="icon-[heroicons--at-symbol] w-3 h-3"></span>
        <span th:text="${currentUser.name}">username</span>
      </p>
    </div>
  </div>

  <!-- 简介 -->
  <p th:if="${currentUser.bio != null and !#strings.isEmpty(currentUser.bio)}" 
    class="text-sm text-base-content/60 leading-relaxed line-clamp-2 mt-4"
    th:text="${currentUser.bio}">描述...</p>

  <!-- 快捷入口 -->
  <div class="flex items-center gap-2 mt-4 pt-3 border-t border-base-content/5">
    <a th:href="${currentUser.permalink}" 
       class="flex-1 flex items-center justify-center gap-1 px-3 py-2 rounded-lg bg-base-200/50 hover:bg-primary/10 text-xs text-base-content/60 hover:text-primary transition-all">
      <span class="icon-[heroicons--document-text] w-4 h-4"></span>
      <span>我的文章</span>
    </a>
    <a href="/uc" 
       class="flex-1 flex items-center justify-center gap-1 px-3 py-2 rounded-lg bg-base-200/50 hover:bg-primary/10 text-xs text-base-content/60 hover:text-primary transition-all">
      <span class="icon-[heroicons--cog-6-tooth] w-4 h-4"></span>
      <span>个人中心</span>
    </a>
  </div>
</div>

<!-- ========== 未登录访客卡片 ========== -->
<a th:unless="${isLoggedIn}" href="/about"
  class="card bg-base-100/80 backdrop-blur-xl shadow-lg border border-base-content/5 rounded-2xl p-5 block group hover:shadow-xl hover:border-primary/20 transition-all duration-300 relative overflow-hidden"
  th:with="profile = ${theme.config.about_settings.profile},
           github = ${theme.config.about_settings.github}">

  <!-- 背景装饰 - 多层渐变 -->
  <div class="absolute -top-12 -right-12 w-36 h-36 bg-gradient-to-br from-primary/10 via-secondary/8 to-accent/10 rounded-full blur-2xl group-hover:scale-110 transition-transform duration-500"></div>
  <div class="absolute -bottom-8 -left-8 w-24 h-24 bg-gradient-to-tr from-secondary/8 to-primary/5 rounded-full blur-xl opacity-50"></div>

  <!-- 头像和信息 -->
  <div class="relative flex items-center gap-4">
    <div class="flex-shrink-0">
      <div class="w-12 h-12 rounded-xl overflow-hidden bg-base-200 ring-1 ring-base-content/10 group-hover:ring-primary/30 transition-all">
        <img th:src="${profile?.avatar != null and !profile.avatar.isEmpty()} ? ${profile.avatar} : ${site.logo}" alt="avatar" class="w-full h-full object-cover" />
      </div>
    </div>
    
    <div class="flex-1 min-w-0">
      <h3 class="text-base font-semibold text-base-content truncate" 
          th:text="${profile?.nickname != null and !profile.nickname.isEmpty()} ? ${profile.nickname} : ${site.title}">昵称</h3>
      <p th:if="${profile?.role != null and !profile.role.isEmpty()}" 
         class="text-xs text-base-content/50 mt-0.5" 
         th:text="${profile.role}">博主</p>
    </div>
  </div>

  <!-- 简介 -->
  <p th:if="${profile?.bio != null and !profile.bio.isEmpty()}" 
    class="text-sm text-base-content/60 leading-relaxed line-clamp-2 mt-4"
    th:text="${profile.bio}">个人简介...</p>

  <!-- 底部信息 -->
  <div class="flex items-center justify-between mt-4 pt-3 border-t border-base-content/5 text-xs text-base-content/50">
    <div th:if="${github?.username != null and !github.username.isEmpty()}" class="flex items-center gap-1">
      <span class="icon-[mdi--github] w-4 h-4"></span>
      <span th:text="${github.username}">username</span>
    </div>
    <div th:unless="${github?.username != null and !github.username.isEmpty()}"></div>
    
    <span class="flex items-center gap-1 group-hover:text-primary transition-colors">
      了解更多
      <span class="icon-[heroicons--arrow-right] w-3.5 h-3.5 group-hover:translate-x-0.5 transition-transform"></span>
    </span>
  </div>
</a>

</th:block>

</html>
