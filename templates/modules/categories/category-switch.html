<!DOCTYPE html>
<html xmlns:th="https://www.thymeleaf.org">

<!-- ========================================== -->
<!--        分类切换块组件 - 现代化简约风格      -->
<!-- ========================================== -->

<!-- 
  风格说明 (所有风格都支持折叠):
  1. pills - 药丸风格：简约标签，无外层容器
  2. chips - 芯片风格：圆角边框，带计数
  3. underline - 下划线风格：极简，文字+下划线
  4. glass - 玻璃拟态：轻量毛玻璃
-->

<!-- ===================== -->
<!-- 药丸风格 - 胶囊徽章 -->
<!-- ===================== -->
<div th:fragment="pills(categories, currentCategory)" class="categories-switch-pills mb-8"
  th:with="maxVisible = 6, totalCategories = ${#lists.size(categories)}, needsCollapse = ${totalCategories > maxVisible}"
  x-data="{ expanded: false }">
  <div class="flex flex-wrap items-center gap-2">
    <!-- 全部按钮 -->
    <a th:href="@{/categories}"
      class="inline-flex items-center gap-1.5 px-3.5 py-1.5 rounded-full text-sm font-medium border transition-all duration-200"
      th:classappend="${currentCategory == null} ? 'bg-base-100 text-base-content shadow-sm border-base-content/10' : 'bg-base-100/60 text-base-content/60 border-base-content/5 hover:bg-base-100 hover:text-base-content hover:shadow-sm hover:border-base-content/10'">
      <span class="icon-[heroicons--squares-2x2] w-3.5 h-3.5"></span>
      <span>全部</span>
    </a>

    <!-- 分类 -->
    <th:block th:each="c, iterStat : ${categories}">
      <a th:href="@{${c.status.permalink}}" th:with="postCount=${c.status.postCount ?: 0}"
        class="inline-flex items-center gap-1.5 px-3.5 py-1.5 rounded-full text-sm font-medium border transition-all duration-200"
        th:classappend="${currentCategory != null and currentCategory.metadata.name == c.metadata.name} ? 'bg-base-100 text-base-content shadow-sm border-base-content/10' : 'bg-base-100/60 text-base-content/60 border-base-content/5 hover:bg-base-100 hover:text-base-content hover:shadow-sm hover:border-base-content/10'"
        th:data-collapsible="${needsCollapse and iterStat.index >= maxVisible}"
        th:style="${needsCollapse and iterStat.index >= maxVisible ? 'display: none' : ''}"
        th:attr="x-init=${needsCollapse and iterStat.index >= maxVisible and currentCategory != null and currentCategory.metadata.name == c.metadata.name} ? 'expanded = true' : null"
        x-effect="if ($el.dataset.collapsible === 'true') { $el.style.display = expanded ? '' : 'none' }">
        <span class="icon-[heroicons--folder] w-3.5 h-3.5 text-base-content/40"></span>
        <span th:text="${c.spec.displayName}"></span>
        <span th:if="${postCount > 0}" class="text-xs text-base-content/50" th:text="${postCount}"></span>
      </a>
    </th:block>

    <!-- 展开/收起 -->
    <button th:if="${needsCollapse}" @click="expanded = !expanded"
      class="inline-flex items-center gap-1 px-3 py-1.5 rounded-full text-sm font-medium border border-dashed border-base-content/20 text-base-content/50 hover:text-base-content hover:border-base-content/30 hover:bg-base-100/50 transition-all duration-200 cursor-pointer">
      <span x-show="!expanded" class="icon-[heroicons--chevron-down] w-3.5 h-3.5"></span>
      <span x-show="expanded" class="icon-[heroicons--chevron-up] w-3.5 h-3.5"></span>
      <span x-show="!expanded" th:text="'+' + ${totalCategories - maxVisible}"></span>
      <span x-show="expanded">收起</span>
    </button>
  </div>
</div>

<!-- ===================== -->
<!-- 芯片风格 - 边框卡片   -->
<!-- ===================== -->
<div th:fragment="chips(categories, currentCategory)" class="categories-switch-chips mb-8"
  th:with="maxVisible = 10, totalCategories = ${#lists.size(categories)}, needsCollapse = ${totalCategories > maxVisible}"
  x-data="{ expanded: false }">
  <div class="flex flex-wrap justify-center gap-2">
    <!-- 全部芯片 -->
    <a th:href="@{/categories}"
      class="inline-flex items-center gap-2 h-9 px-4 rounded-lg text-sm font-medium border transition-all duration-200"
      th:classappend="${currentCategory == null} ? 'bg-primary/10 text-primary border-primary/30' : 'bg-base-100 text-base-content/60 border-base-content/10 hover:border-primary/30 hover:text-primary'">
      <span class="icon-[heroicons--squares-2x2] w-4 h-4"></span>
      <span>全部</span>
    </a>

    <!-- 分类芯片 -->
    <th:block th:each="c, iterStat : ${categories}">
      <a th:href="@{${c.status.permalink}}" th:with="postCount=${c.status.postCount ?: 0}"
        class="inline-flex items-center gap-1.5 h-9 px-4 rounded-lg text-sm font-medium border transition-all duration-200"
        th:classappend="${currentCategory != null and currentCategory.metadata.name == c.metadata.name} ? 'bg-primary/10 text-primary border-primary/30' : 'bg-base-100 text-base-content/60 border-base-content/10 hover:border-primary/30 hover:text-primary'"
        th:data-collapsible="${needsCollapse and iterStat.index >= maxVisible}"
        th:style="${needsCollapse and iterStat.index >= maxVisible ? 'display: none' : ''}"
        th:attr="x-init=${needsCollapse and iterStat.index >= maxVisible and currentCategory != null and currentCategory.metadata.name == c.metadata.name} ? 'expanded = true' : null"
        x-effect="if ($el.dataset.collapsible === 'true') { $el.style.display = expanded ? '' : 'none' }">
        <span class="icon-[heroicons--folder] w-4 h-4 opacity-50"></span>
        <span th:text="${c.spec.displayName}"></span>
        <span th:if="${postCount > 0}" class="text-xs opacity-50" th:text="'(' + ${postCount} + ')'"></span>
      </a>
    </th:block>

    <!-- 展开/收起 -->
    <button th:if="${needsCollapse}" @click="expanded = !expanded"
      class="inline-flex items-center gap-1 h-9 px-3 rounded-lg text-sm font-medium border border-dashed border-primary/30 text-primary/70 hover:text-primary hover:bg-primary/5 transition-all duration-200 cursor-pointer">
      <span x-show="!expanded" class="icon-[heroicons--plus] w-4 h-4"></span>
      <span x-show="expanded" class="icon-[heroicons--minus] w-4 h-4"></span>
      <span x-show="!expanded" th:text="${totalCategories - maxVisible}"></span>
      <span x-show="expanded">收起</span>
    </button>
  </div>
</div>

<!-- ===================== -->
<!-- 下划线风格 - 极简     -->
<!-- ===================== -->
<div th:fragment="underline(categories, currentCategory)" class="categories-switch-underline mb-8"
  th:with="maxVisible = 12, totalCategories = ${#lists.size(categories)}, needsCollapse = ${totalCategories > maxVisible}"
  x-data="{ expanded: false }">
  <div class="flex flex-wrap justify-center items-center gap-x-1 gap-y-0 border-b border-base-content/10 pb-px">
    <!-- 全部 -->
    <a th:href="@{/categories}" class="relative px-3 py-2.5 text-sm font-medium transition-colors duration-200"
      th:classappend="${currentCategory == null} ? 'text-primary' : 'text-base-content/50 hover:text-base-content'">
      <span>全部</span>
      <span th:if="${currentCategory == null}"
        class="absolute bottom-0 left-1 right-1 h-0.5 bg-primary rounded-full"></span>
    </a>

    <!-- 分类 -->
    <th:block th:each="c, iterStat : ${categories}">
      <a th:href="@{${c.status.permalink}}" th:with="postCount=${c.status.postCount ?: 0}"
        class="relative px-3 py-2.5 text-sm font-medium transition-colors duration-200"
        th:classappend="${currentCategory != null and currentCategory.metadata.name == c.metadata.name} ? 'text-primary' : 'text-base-content/50 hover:text-base-content'"
        th:data-collapsible="${needsCollapse and iterStat.index >= maxVisible}"
        th:style="${needsCollapse and iterStat.index >= maxVisible ? 'display: none' : ''}"
        th:attr="x-init=${needsCollapse and iterStat.index >= maxVisible and currentCategory != null and currentCategory.metadata.name == c.metadata.name} ? 'expanded = true' : null"
        x-effect="if ($el.dataset.collapsible === 'true') { $el.style.display = expanded ? '' : 'none' }">
        <span th:text="${c.spec.displayName}"></span>
        <sup th:if="${postCount > 0}" class="ml-0.5 text-xs opacity-40" th:text="${postCount}"></sup>
        <span th:if="${currentCategory != null and currentCategory.metadata.name == c.metadata.name}"
          class="absolute bottom-0 left-1 right-1 h-0.5 bg-primary rounded-full"></span>
      </a>
    </th:block>

    <!-- 展开/收起 -->
    <button th:if="${needsCollapse}" @click="expanded = !expanded"
      class="px-3 py-2.5 text-sm font-medium text-primary/60 hover:text-primary transition-colors duration-200 cursor-pointer">
      <span x-show="!expanded" th:text="'+' + ${totalCategories - maxVisible} + ' 更多'"></span>
      <span x-show="expanded">收起</span>
    </button>
  </div>
</div>

<!-- ===================== -->
<!-- 玻璃拟态风格 - 轻量   -->
<!-- ===================== -->
<div th:fragment="glass(categories, currentCategory)" class="categories-switch-glass mb-8"
  th:with="maxVisible = 10, totalCategories = ${#lists.size(categories)}, needsCollapse = ${totalCategories > maxVisible}"
  x-data="{ expanded: false }">
  <div class="flex flex-wrap justify-center gap-2 p-3 rounded-2xl bg-base-200/40 backdrop-blur-sm dark:bg-base-300/30">
    <!-- 全部 -->
    <a th:href="@{/categories}" class="px-4 py-2 rounded-xl text-sm font-medium transition-all duration-200"
      th:classappend="${currentCategory == null} ? 'bg-base-100 text-base-content shadow-sm dark:bg-base-100/90' : 'text-base-content/50 hover:text-base-content hover:bg-base-100/60'">
      全部
    </a>

    <!-- 分类 -->
    <th:block th:each="c, iterStat : ${categories}">
      <a th:href="@{${c.status.permalink}}" th:with="postCount=${c.status.postCount ?: 0}"
        class="inline-flex items-center gap-1.5 px-4 py-2 rounded-xl text-sm font-medium transition-all duration-200"
        th:classappend="${currentCategory != null and currentCategory.metadata.name == c.metadata.name} ? 'bg-base-100 text-base-content shadow-sm dark:bg-base-100/90' : 'text-base-content/50 hover:text-base-content hover:bg-base-100/60'"
        th:data-collapsible="${needsCollapse and iterStat.index >= maxVisible}"
        th:style="${needsCollapse and iterStat.index >= maxVisible ? 'display: none' : ''}"
        th:attr="x-init=${needsCollapse and iterStat.index >= maxVisible and currentCategory != null and currentCategory.metadata.name == c.metadata.name} ? 'expanded = true' : null"
        x-effect="if ($el.dataset.collapsible === 'true') { $el.style.display = expanded ? '' : 'none' }">
        <span th:text="${c.spec.displayName}"></span>
        <span th:if="${postCount > 0}" class="px-1.5 py-0.5 rounded-md text-xs bg-base-content/10"
          th:text="${postCount}"></span>
      </a>
    </th:block>

    <!-- 展开/收起 -->
    <button th:if="${needsCollapse}" @click="expanded = !expanded"
      class="px-4 py-2 rounded-xl text-sm font-medium text-primary/70 hover:text-primary hover:bg-base-100/60 transition-all duration-200 cursor-pointer">
      <span x-show="!expanded" class="inline-flex items-center gap-1">
        <span th:text="'+' + ${totalCategories - maxVisible}"></span>
      </span>
      <span x-show="expanded">收起</span>
    </button>
  </div>
</div>

</html>