/**
 * å¤©æ°”è”åŠ¨ç‰¹æ•ˆæ ·å¼ - Pro Max (V3)
 * ç»ˆæå¡é€šçœŸå®æ„Ÿèåˆç‰ˆ
 */

:root {
  --weather-transition: 1.5s cubic-bezier(0.4, 0, 0.2, 1);
  --wind-force: 1;
  --temp-glow-hue: 210;
  --temp-glow-opacity: 0;
  --humidity-blur: 0px;
  --humidity-opacity: 0;
}

/* ========================================
   åŸºç¡€å®¹å™¨
======================================== */
.weather-effect {
  position: absolute;
  inset: 0;
  overflow: hidden;
  z-index: 0;
  transition: background var(--weather-transition);
}

.weather-effect-layer {
  position: absolute;
  inset: 0;
  pointer-events: none;
  /* å¼€å¯ 3D è§†è§’ï¼Œè®©å±‚çº§å…³ç³»æ›´æ˜ç¡® */
  perspective: 1000px;
  transform-style: preserve-3d;
  z-index: 5;
  /* ç¡®ä¿å†…å®¹åœ¨èƒŒæ™¯ä¹‹ä¸Š */
}

/* ========================================
   1. åŠ¨æ€èƒŒæ™¯ (Atmosphere)
======================================== */
/* æ™´å¤©ï¼šæ¸…çˆ½å¤©è“ */
.weather-sunny {
  background: linear-gradient(180deg, #4facfe 0%, #00f2fe 100%);
}

.weather-sunny .atmosphere-glow {
  background: radial-gradient(circle at 80% 20%, rgba(255, 255, 200, 0.3) 0%, transparent 60%);
}

/* å¤šäº‘ï¼šæ˜äº®è“å¤© */
.weather-cloudy {
  background: linear-gradient(180deg, #89f7fe 0%, #66a6ff 100%);
}

/* å¤œæ™šï¼šæ·±é‚ƒè“ç´« */
.weather-night-clear,
.weather-night-cloudy {
  background: linear-gradient(to bottom, #0f2027 0%, #203a43 50%, #2c5364 100%);
}

/* é›¾å¤©ï¼šæŸ”å’Œç°è“ï¼Œæ¸è¿›è¿‡æ¸¡ */
.weather-foggy {
  background: linear-gradient(180deg,
      #9ca8b3 0%,
      /* é¡¶éƒ¨æŸ”å’Œç° */
      #6b7b8a 40%,
      /* ä¸­é—´è¿‡æ¸¡ */
      #3d4f5f 100%
      /* åº•éƒ¨æ·±ç°è“ */
    );
}

/* é›¨å¤©ï¼šç°è“å‹æŠ‘ */
.weather-rainy {
  background: linear-gradient(180deg, #373B44 0%, #4286f4 100%);
}

/* é›·æš´ï¼šæ·±ç´«é»‘ */
.weather-stormy {
  background: linear-gradient(180deg, #141E30 0%, #243B55 100%);
}

/* é›ªå¤©ï¼šé»˜è®¤ï¼ˆæ·±è‰²ä¸»é¢˜ï¼‰å†·è‰²è°ƒè“ç°æ¸å˜ */
.weather-snowy {
  background: linear-gradient(180deg,
      #4a6a8a 0%,
      /* æ·±å†·è“ç°é¡¶éƒ¨ */
      #6a8aaa 40%,
      /* ä¸­é—´è¿‡æ¸¡ */
      #8aa4be 100%
      /* åº•éƒ¨ */
    );
}

/* é›ªå¤©ï¼šäº®è‰²ä¸»é¢˜ - æ›´æ·±çš„èƒŒæ™¯å¢å¼ºé›ªèŠ±å¯è§æ€§ */
[data-color-scheme="light"] .weather-snowy {
  background: linear-gradient(180deg,
      #5a7a9a 0%,
      /* å†·è“ç°é¡¶éƒ¨ */
      #7a9ab8 50%,
      /* ä¸­é—´ */
      #9ab4cc 100%
      /* åº•éƒ¨åæµ…è“ç° */
    );
}

.atmosphere-glow {
  position: absolute;
  inset: 0;
  z-index: 0;
  opacity: 0.6;
  mix-blend-mode: overlay;
  animation: breathe 8s ease-in-out infinite;
}


/* ========================================
   2. æ™´å¤© (Sunny) - é˜³å…‰è‰åª (Stylized Lawn)
======================================== */
.sunny-scene-container {
  position: absolute;
  inset: 0;
  overflow: hidden;
  z-index: 5;
  pointer-events: none;
}

/* è‰åªåœ°åŸº */
.sunny-lawn {
  position: absolute;
  bottom: 0;
  width: 120%;
  left: -10%;
  height: 180px;
  background: #88d44e;
  /* æ˜äº®è‰ç»¿ */
  border-radius: 50% 50% 0 0;
  /* æè½»å¾®å¼§åº¦ï¼Œæ¥è¿‘å¹³ç›´ */
  z-index: 2;
  box-shadow: 0 -5px 30px rgba(100, 200, 50, 0.3);
}

[data-color-scheme="dark"] .sunny-lawn {
  background: #2e4d38;
  /* æ·±è‰²è‰åª */
  box-shadow: 0 -5px 30px rgba(0, 50, 20, 0.5);
}

/* å‰æ™¯è£…é¥°æ€§è‰å¶ (CSSç»˜åˆ¶) */
.sunny-grass-blade {
  position: absolute;
  bottom: 0;
  width: 6px;
  height: 25px;
  background: #66bb2a;
  border-radius: 5px 5px 0 0;
  z-index: 5;
  transform-origin: bottom center;
  animation: grass-sway calc(4s / var(--life-scale, 1)) ease-in-out infinite alternate;
}

@keyframes grass-sway {
  0% {
    transform: rotate(calc(-8deg + 15deg * var(--wind-force-x, 0)));
  }

  100% {
    transform: rotate(calc(8deg + 15deg * var(--wind-force-x, 0)));
  }
}

[data-color-scheme="dark"] .sunny-grass-blade {
  background: #223e2a;
}


/* ç²¾è‡´èŠ±æœµ */
.sunny-flower-detailed {
  position: absolute;
  bottom: 20px;
  /* æ’åœ¨è‰åªä¸Š */
  width: 30px;
  height: 60px;
  transform-origin: bottom center;
  z-index: 4;
  animation: flower-sway calc(5s / var(--life-scale, 1)) ease-in-out infinite alternate;
}

/* èŠ±èŒ */
.sunny-flower-detailed::before {
  content: '';
  position: absolute;
  bottom: 0;
  left: 50%;
  transform: translateX(-50%);
  width: 4px;
  height: 100%;
  background: #4caf50;
  border-radius: 2px;
}

/* èŠ±å† å®¹å™¨ */
.flower-head {
  position: absolute;
  top: 0;
  left: 50%;
  width: 30px;
  height: 30px;
  transform: translateX(-50%);
}

/* éƒé‡‘é¦™å‹ (Tulip) */
.flower-type-tulip .flower-head {
  background: #ff5252;
  border-radius: 0 0 10px 10px;
  clip-path: polygon(0% 0%, 20% 20%, 50% 0%, 80% 20%, 100% 0%, 100% 100%, 0% 100%);
  transform: translateX(-50%) rotate(180deg);
  /* ç¿»è½¬ä½¿å¾—èŠ±å£æœä¸Š */
  box-shadow: inset 0 -5px 10px rgba(0, 0, 0, 0.1);
}

/* é›èŠå‹ (Daisy) */
.flower-type-daisy .flower-head {
  background: #fff;
  border-radius: 50%;
  box-shadow:
    0 0 0 4px #ffeb3b inset,
    /* èŠ±è•Š */
    0 0 0 8px #fff;
  /* èŠ±ç“£æš—ç¤º */
  width: 20px;
  height: 20px;
}

/* å¤ªé˜³èŠ±å‹ (Sunflower) */
.flower-type-sunflower .flower-head {
  background: #ffa000;
  border-radius: 50%;
  box-shadow: 0 0 0 6px #ffeb3b;
}


@keyframes flower-sway {
  0% {
    transform: rotate(calc(-5deg + 20deg * var(--wind-force-x, 0))) scale(0.95);
  }

  100% {
    transform: rotate(calc(5deg + 20deg * var(--wind-force-x, 0))) scale(1.05);
  }
}

/* å¤ªé˜³å®¹å™¨ */
.sun-container {
  position: absolute;
  /* ========================================
   2. å¤ªé˜³ (Sun) - åˆ†å±‚åŠ¨ç”» (Existing)
======================================== */
  top: 10%;

  right: 10%;
  width: 140px;
  height: 140px;
  z-index: 10;
  filter: drop-shadow(0 0 20px rgba(255, 200, 50, 0.6));
}

.sun-rays {
  position: absolute;
  inset: 0;
  animation: spin 60s linear infinite;
  /* åªæœ‰å…‰èŠ’æ—‹è½¬ */
}

.sun-body {
  position: absolute;
  inset: 0;
  animation: float 6s ease-in-out infinite;
  /* è„¸éƒ¨è½»å¾®æµ®åŠ¨ */
}

.sun-glow-outer {
  position: absolute;
  top: 50%;
  left: 50%;
  width: 300%;
  height: 300%;
  transform: translate(-50%, -50%);
  background: radial-gradient(circle, rgba(255, 255, 255, 0.2) 0%, transparent 70%);
  border-radius: 50%;
  animation: pulse 4s ease-in-out infinite;
}

.bokeh-particle {
  position: absolute;
  border-radius: 50%;
  background: radial-gradient(circle, rgba(255, 255, 255, 0.8), rgba(255, 255, 255, 0));
  filter: blur(2px);
  animation: float-up linear infinite;
}

/* ========================================
   3. æœˆäº® (Moon)
======================================== */
.moon-container {
  position: absolute;
  top: 10%;
  right: 15%;
  width: 100px;
  height: 100px;
  z-index: 10;
  filter: drop-shadow(0 0 15px rgba(255, 255, 255, 0.6));
}

.cloudy-moon {
  opacity: 0.8;
  filter: blur(1px) drop-shadow(0 0 20px rgba(255, 255, 255, 0.4));
}

.moon-icon {
  width: 100%;
  height: 100%;
  transform: rotate(-15deg);
  animation: float 8s ease-in-out infinite;
}

.moon-glow {
  position: absolute;
  top: 50%;
  left: 50%;
  width: 250%;
  height: 250%;
  transform: translate(-50%, -50%);
  background: radial-gradient(circle, rgba(255, 255, 255, 0.15) 0%, transparent 70%);
  border-radius: 50%;
  animation: breathe 5s infinite;
}

.star {
  position: absolute;
  background: white;
  border-radius: 50%;
  box-shadow: 0 0 4px white;
  animation: twinkle ease-in-out infinite;
  z-index: 5;
}

.star.dim {
  opacity: 0.4 !important;
}

/* ========================================
   4. å¡é€šäº‘æœµ (Cartoon Cloud)
======================================== */
.cloud-cartoon {
  position: absolute;
  /* å…³é”®ä¿®å¤ï¼šå¯ç”¨ç»å¯¹å®šä½ */
  width: 280px;
  height: 160px;
  z-index: 20;
  filter: drop-shadow(0 10px 15px rgba(0, 0, 0, 0.1));
  animation: cloud-drift linear infinite;
  will-change: transform;
}

.cloud-cartoon svg {
  width: 100%;
  height: 100%;
  overflow: visible;
  /* é˜²æ­¢ SVG å†…éƒ¨è£å‰ª */
}

.cloud-cartoon.day {
  color: #ffffff;
}

.cloud-cartoon.night {
  color: #636e72;
  /* æ·±è‰²å¤œäº‘ */
  opacity: 0.8;
}

/* ========================================
   4. æ˜Ÿç©ºæ£®æ— (Starry Forest)
======================================== */
.night-scene-container {
  position: absolute;
  inset: 0;
  overflow: hidden;
  z-index: 5;
  pointer-events: none;
}

/* å¤œæ™šè¿œå±± */
.night-mountain {
  position: absolute;
  bottom: 0;
  width: 0;
  height: 0;
  border-left: 150px solid transparent;
  border-right: 150px solid transparent;
  border-bottom: 300px solid #1a1a2e;
  /* æ·±è“é»‘ */
  z-index: 1;
  opacity: 0.8;
}

.nm-1 {
  left: -100px;
  transform: scale(1.8);
  z-index: 1;
  border-bottom-color: #16213e;
}

.nm-2 {
  right: -50px;
  bottom: -50px;
  transform: scale(2.2);
  z-index: 1;
  border-bottom-color: #0f3460;
  opacity: 0.6;
}

/* æ£®æ—å‰ªå½± */
.night-forest {
  position: absolute;
  bottom: 0;
  width: 100%;
  height: 150px;
  background-image:
    linear-gradient(to top, #0f0f1a 0%, transparent 100%),
    repeating-linear-gradient(90deg,
      transparent 0, transparent 40px,
      #050510 40px, #050510 50px);
  /* ç®€æ˜“æ ‘å¹²æ¨¡æ‹Ÿ */
  z-index: 3;
}

/* æ ‘å†  SVG å½¢çŠ¶ (ä½¿ç”¨ mask æˆ– ä¼ªå…ƒç´ æ¨¡æ‹Ÿ) -> ç®€åŒ–ä¸ºä¸‰è§’å½¢æ ‘æ— */
.night-tree {
  position: absolute;
  bottom: 0;
  width: 0;
  height: 0;
  border-left: 25px solid transparent;
  border-right: 25px solid transparent;
  border-bottom: 120px solid #000;
  z-index: 3;
}

[data-color-scheme="light"] .night-tree {
  border-bottom-color: #2c3e50;
  /* äº®è‰²æ¨¡å¼ä¸‹çš„å¤œæ™¯æ ‘ç¨å¾®äº®ä¸€ç‚¹ */
}

/* è¤ç«è™« */
.night-firefly {
  position: absolute;
  width: 4px;
  height: 4px;
  background: #ccff00;
  border-radius: 50%;
  box-shadow: 0 0 8px #ccff00;
  opacity: 0;
  animation: firefly-float 6s ease-in-out infinite;
  z-index: 10;
}

@keyframes firefly-float {

  0%,
  100% {
    transform: translate(0, 0) scale(1);
    opacity: 0;
  }

  20% {
    opacity: 0.8;
  }

  50% {
    transform: translate(20px, -30px) scale(1.2);
    opacity: 0.5;
  }

  80% {
    opacity: 0.8;
  }
}

/* ========================================
   4.2 ç‹¼å ¡è¯¡ç§˜æ£®æ— (Spooky Forest - Wolf Castle Style)
======================================== */
/* ææ€–è¿œå±± */
.spooky-mountain {
  position: absolute;
  bottom: 0;
  width: 0;
  height: 0;
  border-left: 200px solid transparent;
  border-right: 200px solid transparent;
  border-bottom: 400px solid #1a0b2e;
  /* æ·±ç´«é»‘ */
  z-index: 1;
  opacity: 0.8;
}

.sm-1 {
  left: -150px;
  transform: scale(1.5);
  border-bottom-color: #240e3e;
}

.sm-2 {
  right: -100px;
  bottom: -80px;
  transform: scale(1.8);
  border-bottom-color: #0f0520;
  opacity: 0.6;
}

/* æ‰­æ›²æ€ªæ ‘ (Spooky Tree) */
.spooky-tree {
  position: absolute;
  bottom: -20px;
  width: 100px;
  height: 250px;
  background: #0d021c;
  /* ææ·±ç´«é»‘ */
  z-index: 3;
  /* ä½¿ç”¨ clip-path æ¨¡æ‹Ÿæ‰­æ›²æ ‘å¹²å’Œåˆ†å‰æ¯æ */
  clip-path: polygon(40% 100%, 60% 100%, 55% 80%,
      /* æ ¹éƒ¨ */
      70% 60%, 50% 50%,
      /* æå¹²1 */
      80% 30%, 60% 35%,
      /* æå¶1 */
      50% 10%, 40% 35%,
      /* é¡¶ç«¯ */
      20% 30%, 30% 50%,
      /* æå¶2 */
      10% 60%, 45% 80%
      /* æ ¹éƒ¨å›è¿ */
    );
  transform-origin: bottom center;
}

/* äº®è‰²æ¨¡å¼ä¸‹çš„æ€ªæ ‘ */
[data-color-scheme="light"] .spooky-tree {
  background: #2c3e50;
}

/* é»‘æš—ä¸­çš„çœ¼ç› */
.spooky-eye-pair {
  position: absolute;
  width: 20px;
  height: 10px;
  z-index: 4;
}

.spooky-eye-pair::before,
.spooky-eye-pair::after {
  content: '';
  position: absolute;
  top: 0;
  width: 6px;
  height: 6px;
  border-radius: 50%;
  background: #ff0055;
  /* çº¢è‰²å‡¶å…‰ */
  box-shadow: 0 0 8px #ff0055;
  animation: eye-blink 4s infinite;
}

.spooky-eye-pair::before {
  left: 0;
}

.spooky-eye-pair::after {
  right: 0;
}

/* é»„è‰²çœ¼ç› */
.eyes-yellow::before,
.eyes-yellow::after {
  background: #ffcc00;
  box-shadow: 0 0 8px #ffcc00;
}

@keyframes eye-blink {

  0%,
  70%,
  100% {
    opacity: 0;
    transform: scaleY(0.1);
  }

  75%,
  95% {
    opacity: 1;
    transform: scaleY(1);
  }

  85% {
    opacity: 1;
    transform: scaleY(0.3);
  }
}

/* çœ¨çœ¼ */

.cloud-cartoon {
  position: absolute;
  width: 250px;
  height: 80px;
  /* 
    é£åŠ›å½¢å˜å…¬å¼ (æ‹‰å®½ & å‹æ‰)
    --wind-force å¹³æ—¶å¾®é£æ˜¯ ~0.5ï¼Œå¤§é£æ˜¯ 2.0+ ç”šè‡³ç‹‚é£ 4.0
    scaleX åŸºç¡€ 1.0ï¼Œæ ¹æ®åŠ›æ‹‰ä¼¸ (æ¯ 1ç‚¹ force å˜å®½ 15%ï¼Œæœ€å¤§1.5å€)
    scaleY åŸºç¡€ 1.0ï¼Œæ ¹æ®åŠ›å‹æ‰ (æ¯ 1ç‚¹ force å‹ç¼© 10%ï¼Œæœ€å°0.6å€)
  */
  --stretch-x: calc(1 + (var(--wind-force, 1) - 1) * 0.15);
  --stretch-y: calc(1 - (var(--wind-force, 1) - 1) * 0.1);

  transform: scale(var(--cloud-scale)) scaleX(var(--stretch-x)) scaleY(var(--stretch-y));
  transform-origin: center center;
  transition: transform 1.5s cubic-bezier(0.2, 0.8, 0.2, 1);
  will-change: transform, opacity;
  animation: cloud-drift-linear linear infinite;
  /* è§£å†³ SVG åœ¨åŠ¨ç”»è¿‡ç¨‹ä¸­å¯èƒ½ä¼šé—ªçƒ/åƒç´ åŒ–çš„é—®é¢˜ */
  -webkit-backface-visibility: hidden;
  backface-visibility: hidden;
}

/* ç§»é™¤åŸæœ‰çš„å›ºå®šé£˜åŠ¨åç§»åŠ¨ç”» */
@keyframes cloud-drift-linear {
  0% {
    transform: scale(var(--cloud-scale)) scaleX(var(--stretch-x)) scaleY(var(--stretch-y)) translateX(calc(100vw + 250px));
  }

  100% {
    transform: scale(var(--cloud-scale)) scaleX(var(--stretch-x)) scaleY(var(--stretch-y)) translateX(-350px);
  }
}

/* å¹½çµé¬¼ç« */
.ghost-firefly {
  position: absolute;
  width: 6px;
  height: 6px;
  background: #00ffcc;
  /* å†·é’è‰² */
  border-radius: 50%;
  box-shadow: 0 0 12px #00ffcc;
  opacity: 0;
  animation: ghost-float 8s ease-in-out infinite;
  z-index: 10;
}

@keyframes ghost-float {

  0%,
  100% {
    transform: translate(0, 0);
    opacity: 0;
  }

  20% {
    opacity: 0.9;
  }

  50% {
    transform: translate(-40px, -60px) scale(1.5);
    opacity: 0.4;
  }

  80% {
    opacity: 0.7;
  }
}


/* ========================================
   5. é›¨ & é›·æš´ (Rain & Storm) - Canvas ç³»ç»Ÿ
======================================== */
/* Canvas å±‚ */
.rain-canvas,
.lightning-canvas {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  pointer-events: none;
}

.rain-canvas {
  z-index: 15;
}

.lightning-canvas {
  z-index: 12;
  /* åœ¨é›¨åé¢ */
}

/* é—ªå…‰é®ç½© (é›·å‡»æ—¶å…¨å±é—ªç™½) */
.flash-overlay {
  position: absolute;
  inset: 0;
  background: white;
  opacity: 0;
  pointer-events: none;
  z-index: 20;
  mix-blend-mode: overlay;
  transition: opacity 0.05s;
}

/* éœ‡åŠ¨æ•ˆæœ (é›·å‡»æ—¶) */
.weather-shake {
  animation: weather-shake 0.4s cubic-bezier(.36, .07, .19, .97) both;
}

@keyframes weather-shake {

  10%,
  90% {
    transform: translate3d(-1px, 0, 0);
  }

  20%,
  80% {
    transform: translate3d(2px, 0, 0);
  }

  30%,
  50%,
  70% {
    transform: translate3d(-3px, 0, 0);
  }

  40%,
  60% {
    transform: translate3d(3px, 0, 0);
  }
}

/* é›·æš´äº‘å±‚å˜æš— */
.weather-stormy .cloud-cartoon {
  filter: brightness(0.6) saturate(0.8);
}

/* --- é›¨å¤©åœ°é¢ç»„ä»¶ --- */
/* --- é›¨å¤©é‡æ„ï¼šæ‰å¹³å‡ ä½•é£ (Flat Geometric Rain) --- */

/* è‰åŸèƒŒæ™¯å®¹å™¨ */
.rain-meadow-container {
  position: absolute;
  inset: 0;
  z-index: 5;
  pointer-events: none;
}

/* æ‰å¹³å±±ä¸˜ (Flat Hills) - å‡å°‘åœ†è§’ï¼Œä½¿ç”¨å¹³ç¼“æ›²çº¿ */
.rain-meadow-hill {
  position: absolute;
  bottom: 0;
  border-radius: 100% 100% 0 0 / 20% 20% 0 0;
  /* æ›´å¹³ç¼“ */
}

.rm-hill-1 {
  background: #2f3640;
  /* æ·±ç°è“ */
  width: 120%;
  height: 160px;
  left: -10%;
  bottom: 0;
  z-index: 3;
}

.rm-hill-2 {
  background: #192a56;
  /* æ·±å¤œè“ */
  width: 140%;
  height: 220px;
  right: -20%;
  bottom: 0;
  z-index: 1;
}

.rm-hill-3 {
  background: #353b48;
  /* å‰æ™¯ç° */
  width: 60%;
  height: 80px;
  right: 0;
  bottom: 0;
  border-radius: 100% 0 0 0;
  z-index: 4;
}

/* ç§¯æ°´æ½­ (æ‰å¹³åŒ–) */
.rain-puddle {
  position: absolute;
  background: rgba(100, 149, 237, 0.4);
  border-radius: 50%;
  transform: scaleY(0.2);
  z-index: 8;
  animation: puddle-ripple 4s infinite;
}

/* ğŸ  æ‰å¹³å°å±‹ (Flat House) */
.flat-rain-house {
  position: absolute;
  bottom: 40px;
  right: 15%;
  width: 140px;
  height: 100px;
  background: #718093;
  /* å†·ç°å¢™é¢ */
  z-index: 5;
  clip-path: polygon(0% 100%, 0% 40%, 50% 0%, 100% 40%, 100% 100%);
  /* äº”è¾¹å½¢æˆ¿å­ */
}

/* çƒŸå›± */
.house-chimney {
  position: absolute;
  top: -30px;
  right: 20px;
  width: 15px;
  height: 30px;
  background: #2f3640;
  z-index: 1;
}

/* æ–¹çª—æˆ· (å‡ ä½•æ„Ÿ) */
.house-window {
  position: absolute;
  bottom: 25px;
  left: 50%;
  transform: translateX(-50%);
  width: 40px;
  height: 40px;
  background: #fbc531;
  /* äº®é»„å…‰ */
  box-shadow: 0 0 15px rgba(251, 197, 49, 0.5);
  z-index: 3;
}

/* çª—æ ¼ (åå­—çº¿) */
.house-window::before {
  content: '';
  position: absolute;
  top: 50%;
  left: 0;
  width: 100%;
  height: 2px;
  background: rgba(0, 0, 0, 0.3);
}

.house-window::after {
  content: '';
  position: absolute;
  top: 0;
  left: 50%;
  width: 2px;
  height: 100%;
  background: rgba(0, 0, 0, 0.3);
}

/* ğŸ’¡ æ‰å¹³è·¯ç¯ (Flat Lamp) */
.flat-rain-lamp {
  position: absolute;
  bottom: 0;
  left: 15%;
  width: 4px;
  height: 180px;
  background: #dcdde1;
  /* æµ…ç°æ† */
  z-index: 6;
}

.lamp-head {
  position: absolute;
  top: 0;
  left: -10px;
  width: 24px;
  height: 24px;
  background: #fbc531;
  border-radius: 50%;
  box-shadow: 0 0 20px #fbc531;
}

.lamp-light {
  position: absolute;
  top: 12px;
  left: -38px;
  width: 80px;
  height: 200px;
  background: linear-gradient(to bottom, rgba(251, 197, 49, 0.3), transparent);
  clip-path: polygon(50% 0, 0 100%, 100% 100%);
  pointer-events: none;
  mix-blend-mode: overlay;
}

/* ğŸ›£ï¸ è‰²å—å°è·¯ (Flat Path) */
.flat-rain-path {
  position: absolute;
  bottom: 0;
  left: 20%;
  width: 100px;
  height: 120px;
  background: #7f8fa6;
  /* è·¯é¢ç° */
  transform: skewX(-40deg);
  z-index: 2;
  opacity: 0.8;
}

/* ========================================
   6. é›ª (Snow) - ä¸»é¢˜æ„ŸçŸ¥
======================================== */
/* ========================================
   6. é›ª (Snow) - å¡é€šå†¬æ—¥é›ªæ™¯ (Cartoon Winter Scene)
======================================== */
.snow-scene-container {
  position: absolute;
  inset: 0;
  overflow: hidden;
  z-index: 10;
  pointer-events: none;
}

/* --- é›ªåœ°åœ°é¢ (Snow Ground) --- */
.snow-ground {
  position: absolute;
  bottom: -100px;
  left: -10%;
  width: 120%;
  height: 250px;
  background: #f0f8ff;
  /* çˆ±ä¸½ä¸è“ */
  border-radius: 50% 50% 0 0;
  z-index: 5;
  box-shadow: 0 -10px 30px rgba(100, 149, 237, 0.2);
}

[data-color-scheme="dark"] .snow-ground {
  background: #2c3e50;
  /* æ·±å¤œé›ªåœ° */
  box-shadow: 0 -10px 30px rgba(10, 20, 30, 0.4);
}

/* --- è¿œæ™¯é›ªå±± (Snow Hills) --- */
.snow-hill {
  position: absolute;
  bottom: 0;
  background: #e6eef5;
  border-radius: 50% 50% 0 0;
  z-index: 2;
}

[data-color-scheme="dark"] .snow-hill {
  background: #34495e;
}

.sh-1 {
  left: -20%;
  width: 80%;
  height: 300px;
  z-index: 2;
}

.sh-2 {
  right: -10%;
  width: 70%;
  height: 350px;
  z-index: 1;
  bottom: 0;
  opacity: 0.8;
}

/* --- é›ªå±‹ (Igloo) - ä¿®å¤é—¨ä½ç½® --- */
.snow-igloo {
  position: absolute;
  bottom: 40px;
  /* ç«™åœ¨é›ªåœ°ä¸Š */
  left: 15%;
  width: 140px;
  height: 90px;
  background: #fff;
  border-radius: 70px 70px 10px 10px;
  /* åŠåœ†é¡¶ */
  box-shadow: inset -10px -5px 20px rgba(0, 0, 0, 0.1), 10px 10px 15px rgba(0, 0, 0, 0.1);
  z-index: 6;
  border: 1px solid #e1ecf4;
}

/* é›ªå±‹çº¹ç† - å†°ç – */
.snow-igloo::before {
  content: '';
  position: absolute;
  inset: 0;
  border-radius: 90px 90px 0 0;
  background-image:
    linear-gradient(rgba(200, 230, 255, 0.4) 1px, transparent 1px),
    linear-gradient(90deg, rgba(200, 230, 255, 0.4) 1px, transparent 1px);
  background-size: 100% 20px, 40px 100%;
  opacity: 0.5;
}

/* é›ªå±‹å…¥å£ */
.snow-igloo-entrance {
  position: absolute;
  bottom: 0;
  left: 50%;
  transform: translateX(-50%);
  /* é—¨å±…ä¸­ */
  width: 50px;
  height: 40px;
  background: #2d3436;
  /* é—¨æ´é¢œè‰² */
  border-radius: 25px 25px 0 0;
  /* æ‹±é—¨ */
  border: 4px solid #fff;
  border-bottom: none;
  box-shadow: inset 0 5px 10px rgba(0, 0, 0, 0.5);
  z-index: 7;
  /* åœ¨é›ªå±‹å‰ */
}

/* å¤œé—´æ¨¡å¼ - é›ªå±‹å…‰æ•ˆ */
[data-color-scheme="dark"] .snow-igloo {
  background: radial-gradient(circle at 30% 30%, #e0e0e0 0%, #90a0b0 100%);
  box-shadow: 0 0 30px rgba(255, 200, 100, 0.1);
}

[data-color-scheme="dark"] .snow-igloo-entrance {
  background: radial-gradient(circle at 50% 100%, #fdcb6e 0%, #34495e 80%);
  /* æš–é»„å…‰é€å‡º */
  box-shadow: 0 0 20px rgba(253, 203, 110, 0.4);
}

/* --- ç§¯é›ªæ¾æ ‘ (Pine Trees) --- */
.snow-pine {
  position: absolute;
  bottom: 80px;
  width: 0;
  height: 0;
  border-left: 30px solid transparent;
  border-right: 30px solid transparent;
  border-bottom: 80px solid #2d3436;
  /* æ ‘å¹²æ·±è‰² */
  z-index: 4;
}

/* ç§¯é›ªæ•ˆæœ */
.snow-pine::after {
  content: '';
  position: absolute;
  top: 0;
  left: -30px;
  width: 0;
  height: 0;
  border-left: 30px solid transparent;
  border-right: 30px solid transparent;
  border-bottom: 25px solid #fff;
  /* ç™½è‰²ç§¯é›ª */
  transform: translateY(6px);
  /* ç¨å¾®ä¸‹ç§» */
}

.sp-1 {
  left: 10%;
  transform: scale(1.2);
  z-index: 6;
}

.sp-2 {
  left: 25%;
  transform: scale(0.8);
  z-index: 3;
  bottom: 100px;
}

.sp-3 {
  right: 5%;
  transform: scale(1.5);
  z-index: 7;
  bottom: 40px;
}

[data-color-scheme="dark"] .snow-pine {
  border-bottom-color: #0f1519;
}

[data-color-scheme="dark"] .snow-pine::after {
  border-bottom-color: #dcdde1;
  opacity: 0.8;
}

/* é£˜é›ªç²’å­å®¹å™¨ - ä¿ç•™ */
.snow-container {
  position: absolute;
  inset: -20%;
  pointer-events: none;
  z-index: 15;
}

.snow-flake-svg {
  position: absolute;
  /* 
    é£æš´é›ªé€è§†æ‹‰ä¼¸ (Motion Blur æ¨¡æ‹Ÿ)
    å¤§é£é›ªä¼šèµ‹äºˆéå¸¸é«˜çš„ --wind-force (> 2.0)ï¼Œæ­¤æ—¶é›ªèŠ±ä¸è¯¥æ˜¯åœ†çš„ã€‚
    åº”è¯¥è¢«æ‹‰ä¼¸æˆçº¿çŠ¶ï¼šscaleX å˜ç»†ï¼ŒscaleY å˜å®½ï¼ˆæ‹‰é«˜ï¼‰
  */
  --snow-stretch-y: calc(1 + (var(--wind-force, 1) - 1) * 0.8);
  --snow-stretch-x: calc(1 - (var(--wind-force, 1) - 1) * 0.1);
  transform: scale(var(--snow-stretch-x), var(--snow-stretch-y));

  animation: snow-fall linear infinite;
  /* é»˜è®¤ï¼šç™½è‰²é›ªèŠ± + è“è‰²é˜´å½±å¢åŠ å¯è§æ€§ */
  filter: drop-shadow(0 0 4px rgba(100, 150, 200, 0.9)) drop-shadow(0 0 8px rgba(255, 255, 255, 0.6));
}

.snow-flake-svg svg {
  color: #ffffff;
}

/* æµ…è‰²ä¸»é¢˜ï¼šé›ªèŠ±åŠ æ·±è‰²é˜´å½± */
[data-color-scheme="light"] .snow-flake-svg {
  filter: drop-shadow(0 0 3px rgba(80, 120, 180, 0.8)) drop-shadow(0 2px 4px rgba(50, 80, 120, 0.5));
}

[data-color-scheme="light"] .snow-flake-svg svg {
  color: #e8f4ff;
  /* æ·¡è“ç™½ï¼Œåœ¨ç°è“èƒŒæ™¯ä¸Šæ›´å¯è§ */
}

/* ========================================
   7. é›¾ (Fog) - æ¸…æ™¨è¿·é›¾åœºæ™¯ (Misty Morning)
======================================== */
/* åœºæ™¯å®¹å™¨ */
.mist-scene-container {
  position: absolute;
  inset: 0;
  overflow: hidden;
  z-index: 10;
  pointer-events: none;
}

/* --- å¤ªé˜³ (Mist Sun) --- */
.mist-sun {
  position: absolute;
  top: 15%;
  right: 20%;
  width: 80px;
  height: 80px;
  background: #fffdf0;
  border-radius: 50%;
  box-shadow: 0 0 40px rgba(255, 253, 240, 0.8), 0 0 100px rgba(255, 220, 100, 0.4);
  z-index: 1;
  opacity: 0.9;
}

/* æ·±è‰²ä¸»é¢˜å¤ªé˜³ */
[data-color-scheme="dark"] .mist-sun {
  background: #e0e0e0;
  box-shadow: 0 0 30px rgba(200, 200, 255, 0.3), 0 0 80px rgba(100, 100, 200, 0.2);
  opacity: 0.6;
}

/* --- è¿œæ™¯å±±è„‰ (Mountains) --- */
.mist-mountain {
  position: absolute;
  bottom: 0;
  width: 0;
  height: 0;
  border-left: 150px solid transparent;
  border-right: 150px solid transparent;
  border-bottom: 300px solid #8fa3b8;
  /* é»˜è®¤ç°è“ */
  z-index: 2;
}

[data-color-scheme="dark"] .mist-mountain {
  border-bottom-color: #2c3e50;
  /* æ·±è‰²ä¸»é¢˜ï¼šæ·±è“ç° */
}

.m-1 {
  left: -50px;
  border-bottom-color: #a3b6c9;
  transform: scale(1.5);
  opacity: 0.8;
  z-index: 1;
}

.m-2 {
  left: 20%;
  border-bottom-color: #7d94a8;
  bottom: -50px;
  z-index: 2;
}

.m-3 {
  right: -100px;
  border-bottom-color: #607d8b;
  transform: scale(2);
  z-index: 1;
}

[data-color-scheme="dark"] .m-1 {
  border-bottom-color: #34495e;
  opacity: 0.6;
}

[data-color-scheme="dark"] .m-2 {
  border-bottom-color: #2c3e50;
}

[data-color-scheme="dark"] .m-3 {
  border-bottom-color: #1a252f;
}


/* --- æ ‘æœ¨ (Trees) --- */
.mist-tree {
  position: absolute;
  bottom: 0;
  background-color: #2f4f4f;
  /* æ·±é’è‰² */
  z-index: 4;
  border-radius: 50% 50% 0 0;
}

.mist-tree::after {
  content: '';
  position: absolute;
  bottom: 0;
  left: 50%;
  transform: translateX(-50%);
  width: 20%;
  height: 140%;
  background-color: inherit;
  z-index: -1;
}

[data-color-scheme="dark"] .mist-tree {
  background-color: #1a2626;
}

.t-1 {
  left: 10%;
  width: 60px;
  height: 150px;
  background-color: #3a5f60;
}

.t-2 {
  left: 40%;
  width: 80px;
  height: 200px;
  bottom: -20px;
  background-color: #264040;
}

.t-3 {
  right: 25%;
  width: 50px;
  height: 120px;
  background-color: #436b6b;
}

.t-4 {
  right: 5%;
  width: 100px;
  height: 250px;
  bottom: -40px;
  background-color: #1e3333;
}

[data-color-scheme="dark"] .t-1 {
  background-color: #203535;
}

[data-color-scheme="dark"] .t-2 {
  background-color: #152222;
}

[data-color-scheme="dark"] .t-3 {
  background-color: #253a3a;
}

[data-color-scheme="dark"] .t-4 {
  background-color: #0f1a1a;
}


/* --- æµåŠ¨é›¾æ°”å±‚ (SVG Background) --- */
.mist-fog-layer {
  position: absolute;
  bottom: 0;
  left: 0;
  width: 200%;
  height: 50%;
  background-image: url('data:image/svg+xml;utf8,<svg viewBox="0 0 1000 300" xmlns="http://www.w3.org/2000/svg"><path d="M0,300 L0,150 Q150,200 300,120 T600,140 T1000,180 V300 Z" fill="rgba(255,255,255,0.5)"/></svg>');
  background-size: 50% 100%;
  animation: moveFog 20s linear infinite;
  pointer-events: none;
}

/* æ·±è‰²ä¸»é¢˜é›¾å±‚ - é™ä½é€æ˜åº¦ */
[data-color-scheme="dark"] .mist-fog-layer {
  background-image: url('data:image/svg+xml;utf8,<svg viewBox="0 0 1000 300" xmlns="http://www.w3.org/2000/svg"><path d="M0,300 L0,150 Q150,200 300,120 T600,140 T1000,180 V300 Z" fill="rgba(200,210,230,0.2)"/></svg>');
}

.mist-layer-1 {
  bottom: -20px;
  height: 40%;
  opacity: 0.9;
  animation-duration: 25s;
  z-index: 6;
}

.mist-layer-2 {
  bottom: 40px;
  height: 60%;
  opacity: 0.6;
  animation-duration: 40s;
  animation-direction: reverse;
  transform: scaleX(-1);
  z-index: 3;
}

.mist-layer-3 {
  bottom: -30px;
  height: 45%;
  opacity: 0.4;
  animation-duration: 15s;
  z-index: 7;
  filter: blur(8px);
}

@keyframes moveFog {
  0% {
    transform: translateX(0);
  }

  100% {
    transform: translateX(-50%);
  }
}

/* --- åŠ¨æ€é›¾å›¢ (JS Generated) --- */
.mist-fog-puff {
  position: absolute;
  background: radial-gradient(circle, rgba(255, 255, 255, 0.7) 0%, rgba(255, 255, 255, 0) 70%);
  border-radius: 50%;
  filter: blur(10px);
  opacity: 0;
  pointer-events: none;
  z-index: 8;
  /* åŠ¨ç”»ç”± JS Web Animations API æ§åˆ¶ï¼Œä½†å®šä¹‰åŸºæœ¬å±æ€§ */
}

[data-color-scheme="dark"] .mist-fog-puff {
  background: radial-gradient(circle, rgba(200, 210, 230, 0.3) 0%, rgba(200, 210, 230, 0) 70%);
}

/* --- å“åº”å¼è°ƒæ•´ --- */
@media (max-width: 768px) {
  .mist-mountain {
    border-bottom-width: 200px;
    border-left-width: 100px;
    border-right-width: 100px;
  }

  .m-2 {
    bottom: -30px;
  }

  .mist-tree {
    transform: scale(0.7);
    transform-origin: bottom center;
  }

  .mist-fog-layer {
    height: 40%;
  }
}

/* ========================================
   8. é›·æš´ (Storm)
======================================== */
.lightning-container {
  position: absolute;
  inset: 0;
  z-index: 18;
  pointer-events: none;
}

.lightning-bolt {
  position: absolute;
  width: 100px;
  height: 200px;
  filter: drop-shadow(0 0 20px #ffeaa7);
  animation: flash-appear 0.2s ease-out forwards;
}

.weather-stormy.flash-active::after {
  content: '';
  position: absolute;
  inset: 0;
  background: rgba(255, 255, 255, 0.2);
  z-index: 99;
  animation: screen-flash 0.2s ease-out;
}

/* ========================================
   å…³é”®å¸§åŠ¨ç”»
======================================== */
@keyframes spin {
  from {
    transform: rotate(0deg);
  }

  to {
    transform: rotate(360deg);
  }
}

@keyframes float {

  0%,
  100% {
    transform: translateY(0);
  }

  50% {
    transform: translateY(-10px);
  }
}

@keyframes breathe {

  0%,
  100% {
    opacity: 0.6;
    transform: scale(1);
  }

  50% {
    opacity: 0.8;
    transform: scale(1.05);
  }
}

@keyframes pulse {

  0%,
  100% {
    transform: translate(-50%, -50%) scale(1);
    opacity: 0.5;
  }

  50% {
    transform: translate(-50%, -50%) scale(1.1);
    opacity: 0.7;
  }
}

@keyframes float-up {
  0% {
    transform: translateY(0) translateX(0);
    opacity: 0;
  }

  100% {
    transform: translateY(-100px) translateX(20px);
    opacity: 0;
  }
}

/* äº‘æœµé£˜ç§»åŠ¨ç”» - ä»å³å‘å·¦é£˜è¿‡æ•´ä¸ªå±å¹• */
@keyframes cloud-drift {
  0% {
    transform: translateX(calc(100vw + var(--cloud-start-offset, 0px))) scale(var(--cloud-scale, 1));
  }

  100% {
    transform: translateX(-100%) scale(var(--cloud-scale, 1));
  }
}

@keyframes twinkle {

  0%,
  100% {
    opacity: 0.3;
    transform: scale(0.8);
  }

  50% {
    opacity: 1;
    transform: scale(1.2);
  }
}

@keyframes rain-fall {
  0% {
    transform: translateY(-50px);
    opacity: 0;
  }

  20% {
    opacity: 1;
  }

  90% {
    opacity: 1;
  }

  100% {
    transform: translateY(100vh);
    opacity: 0;
  }
}

@keyframes snow-fall {
  0% {
    transform: translateY(-50px) translateX(0) rotate(0deg);
    opacity: 0;
  }

  10% {
    opacity: 1;
  }

  100% {
    transform:
      translateY(calc(100vh + 50px)) translateX(calc(var(--wind-offset, 0px) + 20px)) rotate(360deg);
    opacity: 0;
  }
}

@keyframes fog-roll {
  0% {
    transform: translateX(0);
  }

  100% {
    transform: translateX(10%);
  }
}

@keyframes flash-appear {
  0% {
    opacity: 0;
    transform: scaleY(0);
  }

  50% {
    opacity: 1;
    transform: scaleY(1);
  }

  100% {
    opacity: 0;
  }
}

@keyframes screen-flash {
  0% {
    opacity: 0;
  }

  50% {
    opacity: 1;
  }

  100% {
    opacity: 0;
  }
}

/* ========================================
   åº•éƒ¨æ¸å˜è’™ç‰ˆ
======================================== */
.bottom-fade {
  position: absolute;
  bottom: 0;
  left: 0;
  right: 0;
  height: 30vh;
  background: linear-gradient(to top, rgba(0, 0, 0, 0.15), transparent);
  pointer-events: none;
  z-index: 50;
}

/* ========================================
   å“åº”å¼é€‚é…
======================================== */
@media (max-width: 768px) {
  .cloud-cartoon {
    width: 140px;
    height: 80px;
  }

  .sun-container {
    width: 90px;
    height: 90px;
    top: 5%;
    right: 5%;
  }

  .moon-container {
    width: 60px;
    height: 60px;
    top: 5%;
    right: 8%;
  }
}

/* æ€§èƒ½ä¼˜åŒ–æ¨¡å¼ */
@media (prefers-reduced-motion: reduce) {
  * {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
    scroll-behavior: auto !important;
  }
}