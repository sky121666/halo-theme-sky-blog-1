(function(){const g="sky_weather_cache_v12",u={sunBody:`<svg viewBox="0 0 200 200" class="w-full h-full fill-current text-yellow-400">
                <circle cx="100" cy="100" r="60" />
                <g class="sun-face" fill="#cc9900">
                  <circle cx="75" cy="90" r="8" />
                  <circle cx="125" cy="90" r="8" />
                  <path d="M70 120 Q100 145 130 120" stroke="#cc9900" stroke-width="6" fill="none" stroke-linecap="round" />
                  <ellipse cx="60" cy="105" rx="6" ry="3" fill="#ff7e7e" opacity="0.6" />
                  <ellipse cx="140" cy="105" rx="6" ry="3" fill="#ff7e7e" opacity="0.6" />
                </g>
              </svg>`,sunRays:`<svg viewBox="0 0 200 200" class="w-full h-full stroke-current text-yellow-400">
                <g stroke-width="12" stroke-linecap="round">
                  <path d="M100 20 L100 0 M100 180 L100 200 M20 100 L0 100 M180 100 L200 100 M43 43 L29 29 M157 157 L171 171 M43 157 L29 171 M157 43 L171 29" />
                </g>
              </svg>`,moon:`<svg viewBox="0 0 200 200" class="w-full h-full fill-current text-yellow-100">
             <path d="M100 15 A 85 85 0 1 1 100 185 A 65 65 0 1 0 100 15 Z" />
             <circle cx="80" cy="80" r="12" fill="rgba(0,0,0,0.1)" />
             <circle cx="120" cy="120" r="8" fill="rgba(0,0,0,0.1)" />
             <circle cx="90" cy="140" r="5" fill="rgba(0,0,0,0.1)" />
           </svg>`,cloud:`<svg viewBox="0 0 25 25" class="w-full h-full fill-current">
              <path d="M19.5,10 C19.5,6.96 17.04,4.5 14,4.5 C11.6,4.5 9.55,6.03 8.8,8.2 C8.54,8.13 8.27,8.1 8,8.1 C5.24,8.1 3,10.34 3,13.1 C3,15.86 5.24,18.1 8,18.1 L19.5,18.1 C21.98,18.1 24,16.08 24,14 C24,11.92 21.98,10 19.5,10 Z" />
            </svg>`};let v={type:"sunny",temp:20},w=null,r=null;function C(){w=document.getElementById("weather-effect-root"),w&&(r=w.querySelector(".weather-effect-layer"),r&&(A(),X(),K()))}function A(){try{const t=localStorage.getItem(g);if(t){const l=JSON.parse(t);if(bg){bg==="rain"&&(bg="rainy"),bg==="snow"&&(bg="snowy"),bg==="fog"&&(bg="foggy"),v.type=bg,v.temp=parseFloat(l.weather?.temp||20);return}}}catch{}const e=new Date().getHours();v.type=e>=18||e<6?"night-clear":"sunny"}function X(){if(!r)return;r.lastElementChild&&typeof r.lastElementChild._cleanup=="function"&&r.lastElementChild._cleanup(),r.innerHTML="";const e=w.querySelector(".weather-effect");switch(e&&(e.className="weather-effect weather-"+v.type,e.style.setProperty("--wind-force",1)),_(),v.type){case"sunny":L();break;case"cloudy":k(!1);break;case"night-clear":W();break;case"night-cloudy":k(!0);break;case"foggy":G();break;case"rainy":O();break;case"snowy":J();break;case"stormy":Y();break}const t=document.createElement("div");t.className="bottom-fade",r.appendChild(t)}function _(){const e=document.createElement("div");e.className="atmosphere-glow",r.appendChild(e)}function L(){const e=document.createElement("div");e.className="sunny-scene-container";const t=document.createElement("div");t.className="sunny-lawn",e.appendChild(t);for(let n=0;n<40;n++){const s=document.createElement("div");s.className="sunny-grass-blade",s.style.left=`${Math.random()*100}%`,s.style.height=`${15+Math.random()*25}px`,s.style.animationDelay=`${-Math.random()*4}s`,t.appendChild(s)}const l=["flower-type-tulip","flower-type-daisy","flower-type-sunflower"];for(let n=0;n<12;n++){const s=document.createElement("div"),o=l[Math.floor(Math.random()*l.length)];s.className=`sunny-flower-detailed ${o}`;const i=document.createElement("div");i.className="flower-head",s.appendChild(i),s.style.left=`${5+Math.random()*90}%`,s.style.height=`${40+Math.random()*40}px`,s.style.animationDelay=`${-Math.random()*5}s`,s.style.transform=`scale(${.7+Math.random()*.5})`,t.appendChild(s)}r.appendChild(e);const c=document.createElement("div");c.className="sun-container";const m=document.createElement("div");m.className="sun-rays",m.innerHTML=u.sunRays,c.appendChild(m);const d=document.createElement("div");d.className="sun-body",d.innerHTML=u.sunBody,c.appendChild(d);const a=document.createElement("div");a.className="sun-glow-outer",c.appendChild(a),r.appendChild(c);for(let n=0;n<15;n++)q()}function q(){const e=document.createElement("div");e.className="bokeh-particle";const t=20+Math.random()*60;e.style.cssText=`
      width: ${t}px; height: ${t}px;
      left: ${Math.random()*100}%; top: ${Math.random()*80}%;
      opacity: ${.1+Math.random()*.2};
      animation-duration: ${15+Math.random()*20}s;
      animation-delay: ${-Math.random()*20}s;
    `,r.appendChild(e)}function k(e){e?(B(),I(30,!0),S(!0)):L();const t=e?5:8;for(let l=0;l<t;l++)T(e)}function T(e,t){const l=document.createElement("div");l.className="cloud-cartoon "+(e?"night":"day"),l.innerHTML=u.cloud;const c=.6+Math.random()*1.2,m=5+Math.random()*50,d=60+(1.8-c)*40+Math.random()*30,a=e?.3+Math.random()*.2:.85+Math.random()*.15,n=Math.random()*300;l.style.cssText=`
      top: ${m}%;
      left: 0;
      --cloud-scale: ${c};
      --cloud-start-offset: ${n}px;
      opacity: ${a};
      animation-duration: ${d}s;
      animation-delay: ${-Math.random()*d}s;
      z-index: ${20+Math.floor(c*10)};
      color: ${e?"#a0a4b8":"#ffffff"};
    `,r.appendChild(l)}function W(){B(),I(50,!0),S(!1)}function B(){const e=document.createElement("div");e.className="night-scene-container",e.id="night-scene",["sm-1","sm-2"].forEach(a=>{const n=document.createElement("div");n.className=`spooky-mountain ${a}`,e.appendChild(n)});for(let a=0;a<6;a++){const n=document.createElement("div");n.className="spooky-tree";const s=180+Math.random()*100,o=s*.6;n.style.cssText=`
            left: ${-10+Math.random()*110}%; // 覆盖稍宽范围
            width: ${o}px;
            height: ${s}px;
            z-index: ${2+Math.random()*2};
            transform: scaleX(${Math.random()>.5?1:-1}); // 随机翻转
        `,e.appendChild(n)}r.appendChild(e);const c=setInterval(()=>{if(!document.getElementById("night-scene"))return;const a=document.createElement("div"),n=Math.random()>.7;a.className=`spooky-eye-pair ${n?"eyes-yellow":""}`,a.style.left=`${Math.random()*100}%`,a.style.bottom=`${20+Math.random()*100}px`,a.style.animationDelay=`${Math.random()*2}s`,e.appendChild(a),setTimeout(()=>a.remove(),4e3)},2e3),d=setInterval(()=>{if(!document.getElementById("night-scene"))return;const a=document.createElement("div");a.className="ghost-firefly",a.style.left=`${Math.random()*100}%`,a.style.bottom=`${Math.random()*50}%`,e.appendChild(a),setTimeout(()=>a.remove(),8e3)},1500);e._cleanup=()=>{clearInterval(c),clearInterval(d)}}function S(e){const t=document.createElement("div");t.className="moon-container",e&&t.classList.add("cloudy-moon");const l=document.createElement("div");l.className="moon-icon",l.innerHTML=u.moon,t.appendChild(l);const c=document.createElement("div");c.className="moon-glow",t.appendChild(c),r.appendChild(t)}function I(e,t=!1){for(let l=0;l<e;l++){const c=document.createElement("div");c.className="star",t&&c.classList.add("dim");const m=1+Math.random()*3;c.style.cssText=`
        width: ${m}px; height: ${m}px;
        left: ${Math.random()*100}%; top: ${Math.random()*60}%;
        animation-duration: ${2+Math.random()*3}s;
        animation-delay: ${-Math.random()*3}s;
      `,r.appendChild(c)}}function G(){const e=document.createElement("div");e.className="mist-scene-container",e.id="mist-scene";const t=document.createElement("div");t.className="mist-sun",e.appendChild(t),["m-1","m-2","m-3"].forEach(o=>{const i=document.createElement("div");i.className=`mist-mountain ${o}`,e.appendChild(i)}),["t-1","t-2","t-3","t-4"].forEach(o=>{const i=document.createElement("div");i.className=`mist-tree ${o}`,e.appendChild(i)});const m=["mist-layer-2","mist-layer-1","mist-layer-3"],d=[];m.forEach(o=>{const i=document.createElement("div");i.className=`mist-fog-layer ${o}`,e.appendChild(i),d.push(i)}),r.appendChild(e);const n=setInterval(()=>{if(!document.getElementById("mist-scene"))return;const o=document.createElement("div");o.className="mist-fog-puff";const i=Math.random()*180+60,f=Math.random()*35+55,y=Math.random()*10+12,x=(Math.random()-.5)*400;o.style.cssText=`
        width: ${i}px; height: ${i}px;
        top: ${f}%; left: ${Math.random()*100}%;
      `;const M=o.animate([{transform:"translate(0, 0) scale(0.5)",opacity:0},{opacity:.5,offset:.2},{opacity:.5,offset:.8},{transform:`translate(${x}px, -80px) scale(1.8)`,opacity:0}],{duration:y*1e3,easing:"linear",fill:"forwards"});e.appendChild(o),M.onfinish=()=>o.remove()},600),s=o=>{const i=o.clientX/window.innerWidth;d[1]&&(d[1].style.transform=`translateX(${-i*50}px)`),d[0]&&(d[0].style.transform=`translateX(${i*20}px) scaleX(-1)`),d[2]&&(d[2].style.transform=`translateX(${-i*90}px)`)};document.addEventListener("mousemove",s),e._cleanup=()=>{clearInterval(n),document.removeEventListener("mousemove",s)}}function O(){z(!1)}function Y(){z(!0)}function z(e){for(let h=0;h<(e?8:5);h++)T(!0);const t=window.innerWidth,l=e?t/10:t/25,c=Math.min(e?150:60,Math.max(20,Math.floor(l))),m=e?{count:c,speedBase:14,wind:-6,thickness:3,color:"rgba(130, 180, 255, 0.8)"}:{count:c,speedBase:8,wind:-2,thickness:2,color:"rgba(174, 217, 255, 0.6)"},d=document.createElement("canvas");d.className="rain-canvas",d.id="rain-canvas",r.appendChild(d);const a=document.createElement("canvas");a.className="lightning-canvas",a.id="lightning-canvas",r.appendChild(a);const n=document.createElement("div");n.className="flash-overlay",n.id="flash-overlay",r.appendChild(n);const s=document.createElement("div");s.className="rain-ground-props",Z(s),r.appendChild(s);const o=d.getContext("2d"),i=a.getContext("2d");let f,y,x=[],M=[],H=null,b=0;function D(){f=d.width=a.width=r.offsetWidth||window.innerWidth,y=d.height=a.height=r.offsetHeight||window.innerHeight,x.forEach(h=>{h.x>f&&(h.x=Math.random()*f)})}D();let F;const P=()=>{clearTimeout(F),F=setTimeout(()=>{D()},200)};window.addEventListener("resize",P);class Q{constructor(p=!1){this.x=Math.random()*f,this.y=p?Math.random()*y:-50,this.z=Math.random(),this.speed=m.speedBase*(1+this.z)+Math.random()*2,this.len=10+this.z*15,this.thick=m.thickness*(.5+this.z*.5),this.vx=m.wind*(1+(1-this.z))}update(){this.x+=this.vx,this.y+=this.speed,this.y>y-40&&(Math.random()>.85&&M.push(new V(this.x,y-40)),this.reset()),this.x<0&&(this.x=f),this.x>f&&(this.x=0)}reset(){this.x=Math.random()*f,this.y=-50,this.z=Math.random(),this.speed=m.speedBase*(1+this.z)+Math.random()*2}draw(){o.beginPath(),o.moveTo(this.x,this.y),o.lineTo(this.x-this.vx*2,this.y-this.len),o.strokeStyle=m.color,o.lineWidth=this.thick,o.lineCap="round",o.stroke()}}class V{constructor(p,E){this.x=p,this.y=E,this.life=8,this.particles=[];for(let N=0;N<3;N++)this.particles.push({vx:(Math.random()-.5)*4,vy:-Math.random()*3,px:0,py:0})}update(){this.life--,this.particles.forEach(p=>{p.px+=p.vx,p.py+=p.vy,p.vy+=.3})}draw(){const p=this.life/8;o.fillStyle=`rgba(200, 230, 255, ${p})`,this.particles.forEach(E=>{o.beginPath(),o.arc(this.x+E.px,this.y+E.py,2,0,Math.PI*2),o.fill()})}}for(let h=0;h<m.count;h++)x.push(new Q(!0));function j(){i.clearRect(0,0,f,y),i.beginPath();let p=f*.2+Math.random()*f*.6,E=0;for(i.moveTo(p,E);E<y*.7;){const N=(Math.random()-.5)*80,ee=20+Math.random()*40;p+=N,E+=ee,i.lineTo(p,E)}i.strokeStyle="#fff",i.shadowBlur=25,i.shadowColor="#f1c40f",i.lineWidth=3,i.stroke(),i.shadowBlur=0,setTimeout(()=>i.clearRect(0,0,f,y),120)}function U(){n.style.opacity="0.7",setTimeout(()=>{n.style.opacity="0"},80),setTimeout(()=>{n.style.opacity="0.3"},120),setTimeout(()=>{n.style.opacity="0"},200),w.classList.add("weather-shake"),setTimeout(()=>w.classList.remove("weather-shake"),400),j()}function R(){if(document.getElementById("rain-canvas")){o.clearRect(0,0,f,y),x.forEach(h=>{h.update(),h.draw()});for(let h=M.length-1;h>=0;h--)M[h].update(),M[h].draw(),M[h].life<=0&&M.splice(h,1);if(e){const h=Date.now();h>b&&(U(),b=h+2500+Math.random()*4e3)}H=requestAnimationFrame(R)}}b=Date.now()+1e3,R();const $=document.createElement("div");$.id="rain-system",$.style.display="none",$._cleanup=()=>{cancelAnimationFrame(H),window.removeEventListener("resize",P)},r.appendChild($)}function Z(e){const t=document.createElement("div");t.className="rain-meadow-container",["rm-hill-2","rm-hill-1","rm-hill-3"].forEach(a=>{const n=document.createElement("div");n.className=`rain-meadow-hill ${a}`,t.appendChild(n)}),e.appendChild(t);const l=document.createElement("div");l.className="rain-puddle",l.style.cssText="width: 80px; height: 25px; left: 25%; bottom: 15px;",e.appendChild(l);const c=document.createElement("div");c.className="flat-rain-path",e.appendChild(c);const m=document.createElement("div");m.className="flat-rain-house",m.innerHTML=`
          <div class="house-chimney"></div>
          <div class="house-window"></div>
      `,e.appendChild(m);const d=document.createElement("div");d.className="flat-rain-lamp",d.innerHTML=`
          <div class="lamp-head"></div>
          <div class="lamp-light"></div> 
      `,e.appendChild(d)}function J(){const e=document.createElement("div");e.className="snow-scene-container",["sh-1","sh-2"].forEach(n=>{const s=document.createElement("div");s.className=`snow-hill ${n}`,e.appendChild(s)});const l=document.createElement("div");l.className="snow-ground",e.appendChild(l);const c=document.createElement("div");c.className="snow-igloo";const m=document.createElement("div");m.className="snow-igloo-entrance",c.appendChild(m),e.appendChild(c),["sp-1","sp-2","sp-3"].forEach(n=>{const s=document.createElement("div");s.className=`snow-pine ${n}`,e.appendChild(s)}),r.appendChild(e);const a=document.createElement("div");a.className="snow-container";for(let n=0;n<80;n++){const s=document.createElement("div");s.className="snow-flake-svg";const o=Math.random()<.3,i=o?12+Math.random()*10:4+Math.random()*8,f=o?6+Math.random()*4:3+Math.random()*5;Math.random()>.4?s.innerHTML='<svg viewBox="0 0 24 24" class="w-full h-full fill-current"><circle cx="12" cy="12" r="8"/></svg>':s.innerHTML='<svg viewBox="0 0 24 24" class="w-full h-full stroke-current" stroke-width="2"><path d="M12 2v20M2 12h20M4.93 4.93l14.14 14.14M4.93 19.07L19.07 4.93"/></svg>';const y=20;s.style.cssText=`
        left: ${Math.random()*100}%;
        width: ${i}px; height: ${i}px;
        opacity: ${o?.95:.6+Math.random()*.3};
        --wind-offset: ${y}px;
        animation-duration: ${f}s;
        animation-delay: ${-Math.random()*f}s;
      `,a.appendChild(s)}r.appendChild(a)}function K(){const e=w.querySelector(".scroll-mask");if(!e)return;let t=!1;window.addEventListener("scroll",()=>{t||(requestAnimationFrame(()=>{e.style.opacity=window.scrollY>50?"0.3":"0",t=!1}),t=!0)},{passive:!0})}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",()=>{C()}):C()})();window.handleMomentCardGlow=function(g,u){const v=u.querySelector(".moment-glow");if(!v)return;const w=u.getBoundingClientRect(),r=g.clientX-w.left,C=g.clientY-w.top;v.style.left=r+"px",v.style.top=C+"px"};window.showMomentCardGlow=function(g){const u=g.querySelector(".moment-glow");u&&(u.style.opacity="1")};window.hideMomentCardGlow=function(g){const u=g.querySelector(".moment-glow");u&&(u.style.opacity="0")};(function(){const g={titleElement:null,decorationEffect:"none",styleEffect:"none",originalText:"",init(){this.titleElement=document.getElementById("main-title"),this.titleElement&&(this.decorationEffect=this.titleElement.dataset.decorationEffect||"none",this.styleEffect=this.titleElement.dataset.styleEffect||"none",this.originalText=this.titleElement.dataset.originalText||this.titleElement.textContent.trim(),this.applyEffects())},applyEffects(){this.applyDecorationEffect(),this.applyStyleEffect()},applyDecorationEffect(){this.decorationEffect!=="none"&&((this.decorationEffect==="effect-particles"||this.decorationEffect==="effect-starlight")&&(this.titleElement.innerHTML=`<span><span><span>${this.originalText}</span></span></span>`),this.titleElement.classList.add(this.decorationEffect),this.decorationEffect==="effect-neon-edge"&&this.titleElement.setAttribute("data-text",this.originalText))},applyStyleEffect(){this.styleEffect!=="none"&&(this.titleElement.classList.add(this.styleEffect),(this.styleEffect==="effect-marker-pop"||this.styleEffect==="effect-diagonal-split")&&this.titleElement.setAttribute("data-text",this.originalText))}};document.addEventListener("DOMContentLoaded",()=>{g.init()})})();
